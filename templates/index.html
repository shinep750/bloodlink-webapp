{% extends 'base.html' %}

{% block content %}
    <h1>Dashboard</h1>
    
    <!-- Urgent Alerts Section -->
    {% if critical_shortages %}
    <div class="alert-container">
        <div class="alert-icon">
            <i class="fa-solid fa-triangle-exclamation"></i>
        </div>
        <div class="alert-content">
            <h3>Urgent Shortage Alert!</h3>
            <p>The following blood groups are critically low (less than 3 units available): 
                <strong>{{ critical_shortages|join(', ') }}</strong>.
            </p>
        </div>
    </div>
    {% endif %}

    <!-- ==> UPDATED: Dashboard Grid with new card structure <== -->
    <div class="dashboard-grid">
        <!-- Total Donors Card -->
        <div class="card stat-card">
            <div class="stat-card-info">
                <h3>{{ stats.total_donors }}</h3>
                <p>Total Donors</p>
            </div>
            <div class="stat-card-icon">
                <i class="fa-solid fa-users"></i>
            </div>
        </div>

        <!-- Available Blood Bags Card -->
        <div class="card stat-card">
            <div class="stat-card-info">
                <h3>{{ stats.available_bags }}</h3>
                <p>Available Blood Bags</p>
            </div>
            <div class="stat-card-icon">
                <i class="fa-solid fa-syringe"></i>
            </div>
        </div>

        <!-- Total Transfusions Card -->
        <div class="card stat-card">
            <div class="stat-card-info">
                <h3>{{ stats.total_transfusions }}</h3>
                <p>Total Transfusions</p>
            </div>
            <div class="stat-card-icon">
                <i class="fa-solid fa-heart-pulse"></i>
            </div>
        </div>
    </div>

    <!-- Expiring Soon Section -->
    <h2 style="margin-top: 2.5rem;">Inventory Expiring Soon</h2>
    <div class="card">
        <table>
            <thead>
                <tr>
                    <th>Bag ID</th>
                    <th>Blood Group</th>
                    <th>Bank Name</th>
                    <th>Expiry Date</th>
                </tr>
            </thead>
            <tbody>
                {% for bag in expiring_soon %}
                <tr>
                    <td>{{ bag.bag_id }}</td>
                    <td>{{ bag.blood_group }}</td>
                    <td>{{ bag.bank_name }}</td>
                    <td>{{ bag.expiry_date.strftime('%Y-%m-%d') }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" style="text-align: center;">No blood bags are expiring soon.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}


